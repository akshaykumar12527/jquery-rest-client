# CupCoffeeJs jQuery Rest client

Minimal library for restful client based on jQuery Ajax. Include a semaphore that controls the execution of each session. The purpose of this library is to improve the integration with restfull server on the client side using jQuery Ajax based and a structure that allows simulate an asynchronous architecture

### What you should know to use

This library is being built to work with CupCoffee Js, specifically Cupcoffee Auth JWT, but should work perfect mind in any structure, follow these tips: The communication paths generated here are these standards:

##### Create / Insert / Post (Method POST)

<pre>[url_api] / [controller] / [method]</pre>

##### Read / Get (Method GET)

<pre>[url_api] / [controller] / [method] / [id]? Query = query & ...</pre>

##### Update (Method PUT)

<pre>[url_api] / [controller] / [method] / [id]</pre>

##### Delete (DELETE Method)

<pre>[url_api] / [controller] / [method] / [id]</pre>

### Examples
```javascript
    var rest = new $.RestClient('http://localhost:3000')
        rest.add('login') // http://localhost:3000/login
        rest.add('categories', 'api/categories')  //http://localhost:3000/api/categories
        rest.add('comments', 'api/comments') //http://localhost:3000/api/comments
        rest.add('posts', 'api/posts') ////http://localhost:3000/api/posts
        rest.add('users', 'api/users') ////http://localhost:3000/api/users

        rest.login.post({
            'username': "admin",
            "password": "123456"
        }).then(function(data) {
            rest.token(data.token, data.data.id);// Save x-access-token and x-key
            rest.release('login');
        })

        rest.wait('login')

        /*
            None of the sessions below will be performed unless "rest.release ('login')" is executed.
         */

        rest.users.read('find').query({
            'id': '1'
        }).then(function(data) {
            rest.release('user');
            console.log(data)
        })

        rest.categories.wait('post').update('category').data({
            title: 'news',
            id: '3'
        }).then(function(data) {
            rest.comments.delete(3).then(function(data){
                if(data == true){
                    alert('Comment deleted!')
                }
            })
        })

        rest.posts.wait('user').create('add').data({title: 'Hello', content: "Word!"}).then(function(data) {
            rest.release('posts')
        })
```

In this example requests the following order: Read User -> Create Post -> Update Category -> Delete comments

## Options

```json
{
    waitingTime: 300, //Waiting time
    waitLoopLimit: 60, //Quantity connection attempts limit
    logger: 0, // Log display (0 and 1 = all, 2 = only errors)
    fnError: function(msg) { //Called when an error is declared
        //...
    },
    setup: { //jQuery Ajax configuration http://api.jquery.com/jquery.ajax/

        // cache: false,
        dataType: 'json',
        headers: {}
    }
}
```
## Methods

 - `.post, .insert and .create:` Send data in the body of the request using the POST method
 - `.remove, .delete, .del and .destroy:` Send a removal request with request to the url uses the DELETE method
 - `.update:` Sends data in the header of the body using the PUT method
 - `.read, .get:` Send a request to the URL using the GET method
